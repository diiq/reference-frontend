<div class="reference-thumbnail-wrapper"
     ng-mouseleave="deleting = false"
     ng-class="{earmarkable: earmarkable, earmarked: $ctrl.earmarked()}">
  <div class="menu button-bar">
    <div class="earmark" 
         ng-click="$ctrl.toggleEarmark()"
         ng-mouseover="earmarkable = true"
         ng-mouseout="earmarkable = false">
    </div>
    <button class="delete" ng-click="deleting = true">
      <i class="fa fa-trash"></i>
    </button>
  </div>
  <div class="delete-menu button-bar" ng-class="{visible: deleting}">
    <button class="delete" ng-click="$ctrl.delete()">Delete</button>
    <button class="cancel" ng-click="deleting = false">Cancel</button>
  </div>

  <div class="spinner" ng-if="$ctrl.spinning || !$ctrl.reference.square || $ctrl.reference.spin">
    <img ng-src="{{$ctrl.spinnerURL}}">
  </div>

  <a class="biglink" ui-sref="reference({id:'{{$ctrl.reference.id}}'})">
    <img class="square" ng-src="{{$ctrl.reference.square}}">
  </a>
</div>
